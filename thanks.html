<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Thank You — TrueTrend</title>
  <style>
    :root { --brand:#16a34a; --ink:#222; --muted:#666; --bg:#fff; }
    * { box-sizing:border-box; }
    body { margin:0; background:var(--bg); color:var(--ink);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }
    .wrap { max-width:860px; margin:48px auto; padding:0 24px; }
    h1 { font-size:28px; margin:0 0 8px; }
    .muted { color:var(--muted); }
    .card { border:1px solid #eee; border-radius:16px; padding:20px; margin-top:24px;
      box-shadow:0 5px 18px rgba(16,24,40,.04); }
    .row { display:flex; flex-wrap:wrap; gap:16px; }
    .btn { appearance:none; border:0; border-radius:10px; padding:14px 20px;
      background:var(--brand); color:#fff; text-decoration:none; font-weight:600;
      display:inline-flex; align-items:center; gap:10px; cursor:pointer;
      box-shadow:0 5px 14px rgba(22,163,74,.25); }
    .btn:hover { filter:brightness(.95); }
    .ok { color:var(--brand); font-weight:700; }
    code { background:#f6f6f6; padding:2px 6px; border-radius:6px; }
    .error { color:#b91c1c; font-weight:600; }
    .hide { display:none; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Thanks for your purchase! <span class="ok">✔</span></h1>
    <p class="muted">Your download will begin automatically. If it doesn’t, use the button below.</p>

    <div class="card">
      <h2>Direct Download</h2>
      <p class="muted">If the download is blocked, right-click the button and choose <em>Save link as…</em></p>
      <div class="row">
        <a id="downloadBtn" class="btn" href="#">Download Chrome Extension (.zip)</a>
      </div>
      <p id="errorMsg" class="error hide">
        We couldn’t find the file in this deployment. Please refresh in 10–15 seconds, or contact support if this persists.
      </p>
    </div>

    <div class="card">
      <h3>Quick Install Steps</h3>
      <ol class="muted">
        <li>Download the ZIP and extract it.</li>
        <li>Open <code>chrome://extensions</code> in Chrome.</li>
        <li>Enable <strong>Developer mode</strong>.</li>
        <li>Click <strong>Load unpacked</strong> and select the extracted extension folder.</li>
        <li>Done! <span class="ok">✔</span></li>
      </ol>
    </div>
  </div>

  <script>
    // === CHANGE THIS to match where you put the file ===
    // Option A (file under /public/releases):
    // const FILE_URL = '/public/releases/TrueTrend_Chrome_Extension.zip';

    // Option B (file under /releases):
    const FILE_URL = '/releases/TrueTrend_Chrome_Extension.zip';

    const FILE_NAME = 'TrueTrend_Chrome_Extension.zip';
    const btn = document.getElementById('downloadBtn');
    const errorMsg = document.getElementById('errorMsg');

    async function exists(url) {
      try {
        const res = await fetch(url, { method: 'HEAD', cache: 'no-store' });
        return res.ok;
      } catch (_) { return false; }
    }
    function triggerDownload(url) {
      btn.href = url;
      btn.download = FILE_NAME;
      const a = document.createElement('a');
      a.href = url + (url.includes('?') ? '&' : '?') + 't=' + Date.now();
      a.download = FILE_NAME;
      document.body.appendChild(a);
      a.click();
      setTimeout(() => a.remove(), 400);
    }

    (async () => {
      if (await exists(FILE_URL)) {
        btn.href = FILE_URL;
        btn.download = FILE_NAME;
        setTimeout(() => triggerDownload(FILE_URL), 400);
      } else {
        errorMsg.classList.remove('hide');
        btn.href = '#';
      }
    })();
  </script>
</body>
</html>
